var Replacement=function(){function i(){$.ajax({url:c.url,id:0}).success(function(a){"string"==typeof a&&(a=JSON.parse(a)),e=a,j(),m(),$(document).trigger("Replacement.DataLoaded")})}function j(){var a=JSON.stringify(e);localStorage["replacement-data"]=a;var b=(new Date).getTime();localStorage["replacement-time"]=b}function l(){e=JSON.parse(localStorage["replacement-data"]),m(),$(document).trigger("Replacement.DataLoaded")}function m(){for(k in e)"undefined"!=typeof e[k][h]&&e[k][h]==d[g]&&(f=e[k])}function n(){var a=c.map;for(k in a)"undefined"!=typeof f[a[k]]&&(c.skip_empty&&""==f[a[k]]||$(k).html(f[a[k]]));$(document).trigger("Replacement.done")}function o(a){if(utm_keys=c.utm_keys,a&&""!=a||(a=decodeURI(document.location.search)),a.indexOf("?")<0)return{};var h,b={},d=[],e=[],f=[],g=[];g=a.split("?"),h=window.location.pathname,a=g[1],-1!=a.indexOf("#")&&(a=a.substr(0,a.indexOf("#"))),a.indexOf("&")>-1?e=a.split("&"):e[0]=a;var i,j;for(i=0;i<e.length;i++){for(j=0;j<utm_keys.length;j++)e[i].indexOf(utm_keys[j]+"=")>-1&&e[i].indexOf("=")>-1&&(f=e[i].split("="),b[f[0]]=f[1]);f=e[i].split("="),-1==utm_keys.indexOf(f[0])&&d.push(e[i])}return d.length&&(h+="?"+d.join("&")),window.location.hash&&(h+=window.location.hash),c.utm_redirect&&window.history.pushState(window.history.state,"",h),b}function p(){if("undefined"!=typeof c.dependence){var a=c.dependence;c.utm_keys=[];for(k in a)c.utm_keys.push(k),g=k,h=c.dependence[g]}}var g,h,a=!1,b={},c={url:"data.json",utm_keys:["city"],skip_empty:!0},d={},e={},f={};return b.getDataKeys=function(){var a=[];for(k in e)a.push(e[k][h]);return a},b.test=function(){return a?(console.log("config array:"),console.log(c),console.log("utm_keys array:"),console.log(utm_keys),console.log("GET array:"),console.log(d),console.log("DATA array:"),console.log(e),!0):!1},b.init=function(a){$(document).on("Replacement.DataLoaded",n);var b=!1;if("undefined"==typeof $)return console.error("Replacement needs a JQuery, but it's not found"),!1;if(c=$.extend({},c,a),p(),d=o(),$.isEmptyObject(d))"undefined"!=typeof localStorage["replacement-get"]&&(d=JSON.parse(localStorage["replacement-get"]));else{var e=JSON.stringify(d);e!=localStorage["replacement-get"]&&(localStorage["replacement-get"]=e,b=!0)}if("undefined"==typeof localStorage["replacement-data"]||b)i();else{var f=(new Date).getTime(),g=localStorage["replacement-time"];f-g>3e4?i():l()}},b}();